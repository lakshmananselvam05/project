<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Attendance</title>
      <link rel="stylesheet" href="{% static 'css/nav.css' %}">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f2f2f2;
            margin: 10;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: auto;
            padding-top: 40px;
        }

        .card {
            width: 480px;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 0 12px rgba(0,0,0,0.2);
            text-align: center;
            margin-top: 55px;
        }

        h2 {
            color: #333;
            margin-bottom: 15px;
        }

        .info {
            background: #f8f8f8;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 16px;
            color: #444;
            font-weight: bold;
        }

        .btn {
            width: 100%;
            padding: 12px;
            font-size: 17px;
            margin-top: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }

        .login-btn {
            background: #3498db;
            color: white;
        }

        .logout-btn {
            background: #e74c3c;
            color: white;
        }

        .disabled-btn {
            background: #bdc3c7;
            color: white;
            cursor: not-allowed;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            border-bottom: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }

        th {
            background: #3498db;
            color: white;
        }

       

    </style>
</head>
<body>
    {% include "Employee/employee_navbar.html" %}

<div>

    <!-- TODAY'S ATTENDANCE CARD -->
    <div class="card">
        <h2>Today's Attendance</h2>

        <div class="info">
            Date: {{ today }} <br>
            Time: {{ current_time }}<br>
            Check-in Time: {{checkin}}<br>

            {% if total_hours %}
                Total Hours: {{ total_hours }}
            {% endif %}
        </div>

        <form method="post">
            {% csrf_token %}

            {% if not checkin %}
                <button type="submit" name="action" value="login" class="btn login-btn">Check In</button>

            {% elif checkin and not checkout %}
                <button type="submit" name="action" value="logout" class="btn logout-btn">Check Out</button>

            {% else %}
                <button class="btn disabled-btn" disabled>Attendance Completed</button>
            {% endif %}
        </form>

        <!-- BUTTON TO SHOW HISTORY -->
        <form method="get">
            <button type="submit" name="show_history" value="1"
                    class="btn login-btn" style="margin-top:20px;">
                Show Attendance History
            </button>
        </form>
    </div>


    <!-- ONLY SHOW WHEN CLICKED -->
    {% if show_history %}
    <div class="card">
        <h2>Attendance History</h2>

        <form method="get">
            <input type="hidden" name="show_history" value="1">

            <select name="month">
                {% for m in months %}
                    <option value="{{ m.month }}"
                        {% if m.month == selected_month and m.year == selected_year %} selected {% endif %}>
                        {{ m.month }} - {{ m.year }}
                    </option>
                {% endfor %}
            </select>

            <button type="submit" class="btn login-btn" style="margin-top:10px;">
                Filter
            </button>
        </form>

        <!-- âœ… SCROLL WRAPPER ADDED -->
        <div class="history-scroll">
            <table>
                <tr>
                    <th>Date</th>
                    <th>Check In</th>
                    <th>Check Out</th>
                    <th>Total Hours</th>
                    <th>Status</th>
                </tr>

                {% for att in attendance_history %}
                <tr>
                    <td>{{ att.date }}</td>
                    <td>{{ att.check_in }}</td>
                    <td>{{ att.check_out }}</td>
                    <td>{{ att.total_hours }}</td>
                    <td>{{ att.status }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">No attendance found for this month.</td>
                </tr>
                {% endfor %}
            </table>
        </div>

    </div>
    {% endif %}

</div>

</body>
</html>
